(()=>{const $=(t,e=document)=>e.querySelector(t),t=document.querySelector("[data-products-grid]");if(!t)return;const e=$("#pd"),d=$("[data-pd-img]",e),n=$("[data-pd-name]",e),a=$("[data-pd-cat]",e),o=$("[data-pd-desc]",e),c=$("[data-pd-price]",e),r=$("[data-pd-add]",e),i=$("[data-pd-close]",e),s=$("[data-pd-backdrop]",e);let u=null,l=null;function hide(){e.classList.add("hidden"),document.body.style.overflow="",l&&setTimeout(()=>l.focus(),10)}async function openFor(t,s){const p=(await async function ensureProducts(){if(u)return u;const t=await fetch("/assets/data/products.json",{cache:"no-store"});return u=await t.json(),u}()).find(e=>e.id===t);var y;p&&(d.src=p.img,d.alt=p.name,d.loading="lazy",d.decoding="async",n.textContent=p.name,a.textContent=p.category||"",o.textContent=p.description||"",c.textContent=(y=p.price,new Intl.NumberFormat("ms-MY",{style:"currency",currency:"MYR"}).format(y)),r.onclick=()=>{window.Cart?.add(p,1),hide()},function show(t){e.classList.remove("hidden"),document.body.style.overflow="hidden";const d=e.querySelector('[tabindex="-1"]')||i;setTimeout(()=>d&&d.focus(),10),l=t||null}(s))}t.addEventListener("click",t=>{const e=t.target.closest("[data-product-open]");if(e)return void openFor(e.getAttribute("data-product-open"),e);const d=t.target.closest("article.group[data-id], article[data-id]");d&&openFor(d.getAttribute("data-id"),d)}),t.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||!t.target.matches("[data-product-open]")||(t.preventDefault(),openFor(t.target.getAttribute("data-product-open"),t.target))}),i?.addEventListener("click",hide),s?.addEventListener("click",hide),document.addEventListener("keydown",t=>{"Escape"!==t.key||e.classList.contains("hidden")||hide()})})();