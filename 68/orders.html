<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#ff5a5f" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'wasm-unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; manifest-src 'self'; media-src 'self'; object-src 'none'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'">
  <link rel="manifest" href="./manifest.webmanifest" crossorigin="use-credentials" />
  <title>Orders</title>
  <link rel="stylesheet" href="./assets/tailwind.min.css" />
</head>
<body class="min-h-screen bg-bg text-ink dark:bg-darkbg dark:text-slate-100">
  <a href="#mainContent" class="skip-link">Skip to content</a>
  <main id="mainContent" class="max-w-sm mx-auto p-4 pb-28" tabindex="-1">
    <header class="bg-white dark:bg-[#162033] dark:text-slate-100 rounded-2xl shadow-soft p-4 mb-4 flex items-center justify-between gap-3">
      <h1 class="text-xl font-extrabold flex-1">Orders</h1>
      <div class="flex items-center gap-2">
  <button data-cache-info class="text-xs font-semibold px-3 py-1.5 rounded-lg bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-100 border border-slate-300/60 dark:border-slate-600 hover:bg-slate-300 dark:hover:bg-slate-600 transition" data-i18n="trends.cache" aria-label="Cache Info">Cache Info</button>
        <button data-clear-history class="text-xs font-semibold px-3 py-1.5 rounded-lg bg-red-500/10 text-red-600 dark:text-red-300 border border-red-300 dark:border-red-400/40 hover:bg-red-500/20 transition">Clear</button>
      </div>
    </header>

    <section class="mb-4 hidden" data-orders-stats>
      <div class="bg-white dark:bg-slate-800/60 dark:border dark:border-slate-700 rounded-2xl p-4 shadow-soft grid gap-3 text-sm">
        <div class="flex justify-between items-center">
          <h2 class="font-semibold" data-i18n="orders.analytics">Analytics</h2>
          <button data-refresh-stats class="text-[11px] font-semibold text-primary hover:underline">Refresh</button>
        </div>
        <div class="grid gap-2">
          <div class="flex justify-between"><span data-i18n="analytics.totalOrders">Total Orders</span><span data-stat-count>0</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.active">Active (Preparing/Ready)</span><span data-stat-active>0</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.completed">Completed</span><span data-stat-completed>0</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.cancelled">Cancelled</span><span data-stat-cancelled>0</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.totalSpend">Total Spend</span><span data-stat-spend>RM0.00</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.aov">Avg Order Value</span><span data-stat-aov>RM0.00</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.topItem">Top Item</span><span data-stat-top-item>—</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.topQty">Top Item Qty</span><span data-stat-top-qty>0</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.avgPrep">Avg Prep Time</span><span data-stat-avg-prep>—</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.avgReady">Avg Ready Phase</span><span data-stat-avg-ready>—</span></div>
          <div class="flex justify-between"><span data-i18n="analytics.cancelRate">Cancel Rate</span><span data-stat-cancel-rate>0%</span></div>
        </div>
      </div>
    </section>
    <section class="mb-4 hidden" data-orders-trends>
      <div class="bg-white dark:bg-slate-800/60 dark:border dark:border-slate-700 rounded-2xl p-4 shadow-soft grid gap-3 text-sm">
        <div class="flex justify-between items-center">
          <h2 class="font-semibold" data-i18n="trends.title">Trends</h2>
          <div class="flex items-center gap-3">
            <button type="button" data-export-trends class="text-[11px] font-semibold text-primary hover:underline" aria-label="Export CSV">CSV</button>
            <button type="button" data-toggle-trends-detail class="text-[11px] font-semibold text-primary hover:underline" data-i18n="trends.detail">Detail</button>
          </div>
        </div>
        <div class="grid gap-3">
          <div class="grid gap-1">
            <div class="flex justify-between text-[11px]"><span>Active</span><span data-trend-active-last>0</span></div>
            <canvas data-trend-active height="40" class="w-full"></canvas>
          </div>
          <div class="grid gap-1">
            <div class="flex justify-between text-[11px]"><span>Completed</span><span data-trend-completed-last>0</span></div>
            <canvas data-trend-completed height="40" class="w-full"></canvas>
          </div>
          <div class="grid gap-1">
            <div class="flex justify-between text-[11px]"><span>Cancelled %</span><span data-trend-cancel-rate-last>0%</span></div>
            <canvas data-trend-cancel-rate height="40" class="w-full"></canvas>
          </div>
        </div>
        <div data-trends-detail class="hidden text-[10px] leading-relaxed opacity-80"></div>
      </div>
    </section>
    <section data-orders-list class="grid gap-3"></section>
    <p data-orders-empty class="mt-4 text-center text-sm text-muted hidden">No orders yet.</p>
  </main>

  <nav aria-label="Primary" class="fixed bottom-3 inset-x-0 mx-auto max-w-sm bg-white/90 dark:bg-slate-800/80 backdrop-blur rounded-2xl border border-ring dark:border-slate-600 shadow-soft p-2 grid grid-cols-5 md:grid-cols-7 gap-1">
    <a data-tab="home" href="./index.html" class="flex flex-col items-center gap-1 py-2 rounded-xl">🏠<span class="text-xs" data-i18n="nav.home">Home</span></a>
    <a data-tab="menu" href="./menu.html" class="flex flex-col items-center gap-1 py-2 rounded-xl">🍽️<span class="text-xs" data-i18n="nav.menu">Menu</span></a>
    <a data-tab="checkout" href="#/checkout" class="hidden md:flex flex-col items-center gap-1 py-2 rounded-xl">✅<span class="text-xs">Checkout</span></a>
    <a data-tab="orders" href="#/orders" class="hidden md:flex flex-col items-center gap-1 py-2 rounded-xl">📦<span class="text-xs" data-i18n="nav.orders">My Orders</span></a>
    <a data-tab="gift" href="./gift.html" class="flex flex-col items-center gap-1 py-2 rounded-xl">🎁<span class="text-xs" data-i18n="nav.gift">Gift</span></a>
    <a data-tab="rewards" href="./rewards.html" class="flex flex-col items-center gap-1 py-2 rounded-xl">🏆<span class="text-xs" data-i18n="nav.rewards">Rewards</span></a>
    <a data-tab="account" href="./account.html" class="flex flex-col items-center gap-1 py-2 rounded-xl">👤<span class="text-xs" data-i18n="nav.account">Account</span></a>
  </nav>

  <script src="./assets/js/min.js"></script>
</body>
<script>
if('serviceWorker' in navigator){
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js').catch(console.error);
  });
}
</script>
</html>
