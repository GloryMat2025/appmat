(()=>{const t="cart:v1",read=()=>{try{return JSON.parse(localStorage.getItem(t)||"[]")}catch{return[]}},write=e=>localStorage.setItem(t,JSON.stringify(e)),e={add(t,e=1){const n=read(),d=n.findIndex(e=>e.id===t.id);d>=0?n[d].qty+=e:n.unshift({id:t.id,name:t.name,price:t.price,img:t.img,qty:e}),write(n),this.syncBadge()},remove(t){write(read().filter(e=>e.id!==t)),this.syncBadge()},setQty(t,e){const n=read(),d=n.find(e=>e.id===t);d&&(d.qty=e,write(n)),this.syncBadge()},clear(){write([]),this.syncBadge()},items:read,count:()=>read().reduce((t,e)=>t+(e.qty||0),0),initBadge(t="[data-cart-badge]"){this._badge=document.querySelector(t),this.syncBadge()},syncBadge(){const t=this._badge||document.querySelector("[data-cart-badge]");if(!t)return;const e=this.count();t.textContent=String(e),t.classList.toggle("hidden",e<=0)}};window.Cart=e,window.addEventListener("DOMContentLoaded",()=>e.initBadge())})();